import{u as $,r as s,j as e,H as z,L as M,a as b}from"./app-DtqU_Gmt.js";import{A as U,G as o,P as j,b as N,i as G,l as H,m as Y,c as _,E as q,t as X,C as J}from"./AppLayout-C4K4I5xd.js";import{B as d}from"./Button-4k-pObky.js";import{I as k}from"./Input-BpgKxISb.js";import{B as l}from"./badge-BBdevRdg.js";import{P as K}from"./PurchaseOrderDrawer-C-U8GIE7.js";import{E as Q}from"./ExportButtons-BX5RtZeP.js";import{f as W}from"./currency-CAle3Gff.js";import{C as g}from"./x-Cw-ZD_Fb.js";import{C as f}from"./loader-circle-DtoZnQ6b.js";import"./createLucideIcon-BH-qXF_i.js";import"./shield-x-Cz4kXV9c.js";import"./user-cog-BQwjoD4w.js";import"./Dropdown--z3bvfF1.js";import"./transition-DbHxI3Hw.js";import"./arrow-left-BGTcItEv.js";import"./refresh-cw-CcjnuCLI.js";import"./FlashMessages-D-g4FpAa.js";import"./utils-CDN07tui.js";function be({purchase_orders:t=[],filters:i={},suppliers:w=[],products:v=[],routePrefix:a="pharmacy"}){const{shop:C}=$().props,h=C?.currency||"CDF",[n,E]=s.useState(i.from||""),[x,D]=s.useState(i.to||""),[c,R]=s.useState(i.status||""),[A,m]=s.useState(!1),[I,u]=s.useState(null),S=r=>{r.preventDefault(),b.get(route(`${a}.purchases.index`),{from:n||void 0,to:x||void 0,status:c||void 0},{preserveState:!0})},F=r=>{switch(r){case"RECEIVED":return e.jsxs(l,{className:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Reçu"]});case"PARTIALLY_RECEIVED":return e.jsxs(l,{className:"bg-amber-100 text-amber-800 dark:bg-amber-900/50 dark:text-amber-300",children:[e.jsx(f,{className:"h-3 w-3 mr-1"}),"Partiel"]});case"CONFIRMED":return e.jsxs(l,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Confirmé"]});case"CANCELLED":return e.jsxs(l,{className:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Annulé"]});default:return e.jsxs(l,{className:"bg-gray-100 text-gray-800 dark:bg-gray-700/50 dark:text-gray-300",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"Brouillon"]})}},y=()=>{u(null),m(!0)},T=r=>{u(r),m(!0)},L=()=>{b.reload({only:["purchase_orders"]})},B=t.filter(r=>r.status==="RECEIVED").length,O=t.filter(r=>["DRAFT","CONFIRMED"].includes(r.status)).length,P=t.filter(r=>r.status==="RECEIVED").reduce((r,V)=>r+Number(V.total_amount),0),p=r=>W(r,h);return e.jsxs(U,{children:[e.jsx(z,{title:"Bons de Commande"}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[e.jsx(o,{className:"h-6 w-6"}),"Bons de Commande"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Gestion des achats fournisseurs"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{pdfUrl:route(`${a}.exports.purchases.pdf`,{from:n,to:x,status:c}),excelUrl:route(`${a}.exports.purchases.excel`,{from:n,to:x,status:c}),disabled:!t.length}),e.jsxs(d,{onClick:y,children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Nouveau bon"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1",children:t.length}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"bons de commande"})]}),e.jsx("div",{className:"h-12 w-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:e.jsx(N,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Reçus"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1",children:B}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"commandes complètes"})]}),e.jsx("div",{className:"h-12 w-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:e.jsx(g,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"En attente"}),e.jsx("p",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400 mt-1",children:O}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"à réceptionner"})]}),e.jsx("div",{className:"h-12 w-12 bg-amber-100 dark:bg-amber-900/30 rounded-lg flex items-center justify-center",children:e.jsx(f,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total achats"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1",children:p(P)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"commandes reçues"})]}),e.jsx("div",{className:"h-12 w-12 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-gray-500"}),"Filtres"]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:S,className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[150px]",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Du"}),e.jsx(k,{type:"date",value:n,onChange:r=>E(r.target.value),className:"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{className:"flex-1 min-w-[150px]",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Au"}),e.jsx(k,{type:"date",value:x,onChange:r=>D(r.target.value),className:"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{className:"flex-1 min-w-[150px]",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"Statut"}),e.jsxs("select",{className:"w-full h-10 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",value:c,onChange:r=>R(r.target.value),children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"DRAFT",children:"Brouillon"}),e.jsx("option",{value:"CONFIRMED",children:"Confirmé"}),e.jsx("option",{value:"PARTIALLY_RECEIVED",children:"Partiellement reçu"}),e.jsx("option",{value:"RECEIVED",children:"Reçu"}),e.jsx("option",{value:"CANCELLED",children:"Annulé"})]})]}),e.jsxs(d,{type:"submit",className:"inline-flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Filtrer"]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 text-gray-500"}),"Liste des bons (",t.length,")"]})}),t.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(N,{className:"h-12 w-12 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-600 dark:text-gray-300 mb-2",children:"Aucun bon de commande"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Créez votre premier bon pour commencer"}),e.jsxs(d,{onClick:y,children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Nouveau bon"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Fournisseur"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:t.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:r.created_at}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:e.jsx(o,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.supplier_name||"—"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F(r.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-gray-900 dark:text-gray-100",children:p(Number(r.total_amount))}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.status==="DRAFT"&&e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>T(r),className:"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx(d,{variant:"ghost",size:"sm",asChild:!0,className:"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:e.jsx(M,{href:route(`${a}.purchases.show`,r.id),children:e.jsx(q,{className:"h-4 w-4"})})})]})})]},r.id))})]})})]})]}),e.jsx(K,{isOpen:A,onClose:()=>m(!1),purchaseOrder:I,suppliers:w,products:v,currency:h,onSuccess:L,routePrefix:a})]})}export{be as default};
