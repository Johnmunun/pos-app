import{r as x,j as e,z as o,c as j}from"./app-B8F_Smya.js";import{D as E}from"./Drawer-Ch-0G5k5.js";import{L as m}from"./Label-Dhk_jhe5.js";import{I as h}from"./Input-DyZz_-qK.js";import{T as _}from"./textarea-BXphG8CV.js";import{B as k}from"./Button-BSACjJaD.js";import{a1 as S,f as C,o as D,M as F,r as P,t as z}from"./AppLayout-Cyrikcek.js";import{X as A}from"./x-Ce9nIuKt.js";function q({isOpen:f,onClose:g,supplier:s=null,onSuccess:y=null,canCreate:N=!1,canUpdate:w=!1}){const n=!!s,[d,p]=x.useState({name:"",contact_person:"",phone:"",email:"",address:""}),[t,c]=x.useState({}),[l,b]=x.useState(!1);x.useEffect(()=>{p(s?{name:s.name||"",contact_person:s.contact_person||"",phone:s.phone||"",email:s.email||"",address:s.address||""}:{name:"",contact_person:"",phone:"",email:"",address:""}),c({})},[s,f]);const i=(a,r)=>{p(u=>({...u,[a]:r})),t[a]&&c(u=>({...u,[a]:null}))},v=async a=>{if(a.preventDefault(),n&&!w){o.error("Vous n'avez pas la permission de modifier un fournisseur");return}if(!n&&!N){o.error("Vous n'avez pas la permission de créer un fournisseur");return}b(!0),c({});try{let r;n?r=await j.put(route("pharmacy.suppliers.update",s.id),d):r=await j.post(route("pharmacy.suppliers.store"),d),r.data.success?(o.success(r.data.message),g(),y&&y()):o.error(r.data.message||"Une erreur est survenue")}catch(r){r.response?.status===422?r.response.data.errors?c(r.response.data.errors):r.response.data.message&&o.error(r.response.data.message):o.error("Erreur lors de l'enregistrement du fournisseur")}finally{b(!1)}};return e.jsx(E,{isOpen:f,onClose:g,title:n?"Modifier le fournisseur":"Nouveau fournisseur",children:e.jsxs("form",{onSubmit:v,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"name",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(S,{className:"h-4 w-4 text-gray-400"}),"Nom du fournisseur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{id:"name",type:"text",value:d.name,onChange:a=>i("name",a.target.value),placeholder:"Ex: Pharma Distribution SARL",className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-400",required:!0,disabled:l}),t.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.name})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"contact_person",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(C,{className:"h-4 w-4 text-gray-400"}),"Personne de contact"]}),e.jsx(h,{id:"contact_person",type:"text",value:d.contact_person,onChange:a=>i("contact_person",a.target.value),placeholder:"Ex: Jean Dupont",className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-400",disabled:l}),t.contact_person&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.contact_person})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"phone",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(D,{className:"h-4 w-4 text-gray-400"}),"Téléphone"]}),e.jsx(h,{id:"phone",type:"tel",value:d.phone,onChange:a=>i("phone",a.target.value),placeholder:"Ex: +243 999 000 000",className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-400",disabled:l}),t.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.phone})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"email",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(F,{className:"h-4 w-4 text-gray-400"}),"Email"]}),e.jsx(h,{id:"email",type:"email",value:d.email,onChange:a=>i("email",a.target.value),placeholder:"Ex: contact@pharma.com",className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-400",disabled:l}),t.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.email})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"address",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(P,{className:"h-4 w-4 text-gray-400"}),"Adresse"]}),e.jsx(_,{id:"address",value:d.address,onChange:a=>i("address",a.target.value),placeholder:"Ex: 123 Avenue du Commerce, Kinshasa",rows:3,className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-400",disabled:l}),t.address&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.address})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs(k,{type:"button",variant:"outline",onClick:g,className:"w-full sm:w-auto",disabled:l,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Annuler"]}),e.jsxs(k,{type:"submit",className:"w-full sm:w-auto bg-amber-500 dark:bg-amber-600 text-white hover:bg-amber-600 dark:hover:bg-amber-700",disabled:l,children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),l?"Enregistrement...":n?"Enregistrer":"Créer"]})]})]})})}export{q as S};
