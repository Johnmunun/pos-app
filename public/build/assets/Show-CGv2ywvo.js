import{u as B,r as p,j as e,H as D,L as $,a as j,n as d,c as F}from"./app-DtqU_Gmt.js";import{A as L,B as M,f as O,c as R,C as N,p as T,M as E,s as z,t as I,y as U,d as V,R as u}from"./AppLayout-C4K4I5xd.js";import{B as c}from"./Button-4k-pObky.js";import{B as i}from"./badge-BBdevRdg.js";import{C as q}from"./CustomerDrawer-CTKI03Aj.js";import{A as H}from"./arrow-left-BGTcItEv.js";import{C as v,b as P}from"./x-Cw-ZD_Fb.js";import"./createLucideIcon-BH-qXF_i.js";import"./shield-x-Cz4kXV9c.js";import"./user-cog-BQwjoD4w.js";import"./Dropdown--z3bvfF1.js";import"./transition-DbHxI3Hw.js";import"./loader-circle-DtoZnQ6b.js";import"./refresh-cw-CcjnuCLI.js";import"./FlashMessages-D-g4FpAa.js";import"./utils-CDN07tui.js";import"./Drawer-Dy6JDRVK.js";import"./Input-BpgKxISb.js";import"./Label-QVyen-Zj.js";import"./textarea-DdvYib4T.js";function ge({customer:a,routePrefix:r="pharmacy"}){const{auth:n,shop:f}=B().props,b=f?.currency||"CDF",k=n?.permissions||[],l=s=>n?.user?.type==="ROOT"?!0:k.includes(s),x=l(`${r}.customer.edit`),m=l(`${r}.customer.activate`),g=l(`${r}.customer.deactivate`),[w,o]=p.useState(!1),[C,y]=p.useState(!1),_=async()=>{const s=a.status==="inactive",S=s?"activate":"deactivate";if(s&&!m){d.error("Vous n'avez pas la permission d'activer ce client.");return}if(!s&&!g){d.error("Vous n'avez pas la permission de désactiver ce client.");return}y(!0);try{const t=await F.post(route(`${r}.customers.${S}`,a.id));t.data.success?(d.success(t.data.message),j.reload()):d.error(t.data.message)}catch(t){d.error(t.response?.data?.message||"Une erreur est survenue")}finally{y(!1)}},h=s=>s==null?"-":new Intl.NumberFormat("fr-FR",{style:"currency",currency:b}).format(s),A=s=>s==="active"?e.jsxs(i,{className:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),"Actif"]}):e.jsxs(i,{className:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),"Inactif"]});return e.jsxs(L,{children:[e.jsx(D,{title:`Client - ${a.name}`}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"outline",size:"icon",asChild:!0,className:"border-gray-300 dark:border-gray-600",children:e.jsx($,{href:route(`${r}.customers.index`),children:e.jsx(H,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[a.customer_type==="company"?e.jsx(M,{className:"h-6 w-6"}):e.jsx(O,{className:"h-6 w-6"}),a.name]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[A(a.status),e.jsx(i,{variant:"outline",className:"border-gray-400 dark:border-gray-500 text-gray-700 dark:text-gray-300",children:a.customer_type_label})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[x&&e.jsxs(c,{onClick:()=>o(!0),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Modifier"]}),(m||g)&&e.jsx(c,{variant:a.status==="active"?"destructive":"default",onClick:_,disabled:C,children:a.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Désactiver"]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Activer"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Informations du client"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Téléphone"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.phone||"-"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.email||"-"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(z,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Adresse"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.address||"-"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[a.customer_type==="company"&&a.tax_number&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(I,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Numéro fiscal"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.tax_number})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Limite de crédit"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:h(a.credit_limit)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Date d'inscription"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.created_at})]})]})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Statistiques"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total ventes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a.total_sales||0})]})]})}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.jsxs("p",{children:["Dernière mise à jour: ",a.updated_at]})})]})})]}),e.jsxs("div",{className:"lg:col-span-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Ventes récentes"]})}),e.jsx("div",{className:"p-0",children:a.recent_sales?.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase",children:"Montant"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase",children:"Statut"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.recent_sales.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:s.created_at}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-gray-100",children:h(s.total_amount)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(i,{variant:"outline",className:"border-gray-400 dark:border-gray-500 text-gray-700 dark:text-gray-300",children:s.status})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucune vente pour ce client"})]})})]})]})]}),e.jsx(q,{isOpen:w,onClose:()=>o(!1),customer:a,onSuccess:()=>j.reload(),canCreate:!1,routePrefix:r,canUpdate:x})]})}export{ge as default};
