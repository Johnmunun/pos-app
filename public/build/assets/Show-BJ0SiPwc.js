import{u as A,r as h,j as e,H as B,L as D,a as p,n as t,c as P}from"./app-3PKVeuQh.js";import{A as F,B as L,f as M,c as O,C as j,i as R,M as T,l as E,m as U,n as z,d as I,R as N}from"./AppLayout-DSrKCpOy.js";import{B as c}from"./Button-RC9FN5z3.js";import{B as d}from"./badge-Ca6uIRAr.js";import{C as V}from"./CustomerDrawer-vLgi7Yh-.js";import{A as q}from"./arrow-left-CvJq81LS.js";import{C as u,b as H}from"./x-YL0zAneP.js";import"./createLucideIcon-CyiEew_u.js";import"./shield-x-gOy17OJ-.js";import"./user-cog-nVqfHm0b.js";import"./Dropdown-B_QkibTR.js";import"./transition-CufTvwOt.js";import"./loader-circle-D2tkCN5O.js";import"./refresh-cw-L3GUbwVE.js";import"./FlashMessages-bPB7K-Ql.js";import"./Drawer-DXvnJU94.js";import"./Input-5gvkn2nv.js";import"./Label-DCTvEg5s.js";import"./textarea-g7yOinAB.js";function ne({customer:a}){const{auth:l,shop:f}=A().props,v=f?.currency||"USD",b=l?.permissions||[],i=s=>l?.user?.type==="ROOT"?!0:b.includes(s),x=i("pharmacy.customer.edit"),n=i("pharmacy.customer.activate"),m=i("pharmacy.customer.deactivate"),[k,g]=h.useState(!1),[w,o]=h.useState(!1),C=async()=>{const s=a.status==="inactive",S=s?"activate":"deactivate";if(s&&!n){t.error("Vous n'avez pas la permission d'activer ce client.");return}if(!s&&!m){t.error("Vous n'avez pas la permission de désactiver ce client.");return}o(!0);try{const r=await P.post(route(`pharmacy.customers.${S}`,a.id));r.data.success?(t.success(r.data.message),p.reload()):t.error(r.data.message)}catch(r){t.error(r.response?.data?.message||"Une erreur est survenue")}finally{o(!1)}},y=s=>s==null?"-":new Intl.NumberFormat("fr-FR",{style:"currency",currency:v}).format(s),_=s=>s==="active"?e.jsxs(d,{className:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",children:[e.jsx(u,{className:"h-3 w-3 mr-1"}),"Actif"]}):e.jsxs(d,{className:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300",children:[e.jsx(j,{className:"h-3 w-3 mr-1"}),"Inactif"]});return e.jsxs(F,{children:[e.jsx(B,{title:`Client - ${a.name}`}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"outline",size:"icon",asChild:!0,className:"border-gray-300 dark:border-gray-600",children:e.jsx(D,{href:route("pharmacy.customers.index"),children:e.jsx(q,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[a.customer_type==="company"?e.jsx(L,{className:"h-6 w-6"}):e.jsx(M,{className:"h-6 w-6"}),a.name]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[_(a.status),e.jsx(d,{variant:"outline",className:"border-gray-400 dark:border-gray-500 text-gray-700 dark:text-gray-300",children:a.customer_type_label})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[x&&e.jsxs(c,{onClick:()=>g(!0),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Modifier"]}),(n||m)&&e.jsx(c,{variant:a.status==="active"?"destructive":"default",onClick:C,disabled:w,children:a.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Désactiver"]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Activer"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Informations du client"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Téléphone"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.phone||"-"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.email||"-"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Adresse"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.address||"-"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[a.customer_type==="company"&&a.tax_number&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Numéro fiscal"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.tax_number})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Limite de crédit"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:y(a.credit_limit)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(z,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Date d'inscription"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.created_at})]})]})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Statistiques"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total ventes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a.total_sales||0})]})]})}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.jsxs("p",{children:["Dernière mise à jour: ",a.updated_at]})})]})})]}),e.jsxs("div",{className:"lg:col-span-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Ventes récentes"]})}),e.jsx("div",{className:"p-0",children:a.recent_sales?.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase",children:"Montant"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase",children:"Statut"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.recent_sales.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-gray-700 dark:text-gray-300",children:s.created_at}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-gray-100",children:y(s.total_amount)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(d,{variant:"outline",className:"border-gray-400 dark:border-gray-500 text-gray-700 dark:text-gray-300",children:s.status})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(N,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucune vente pour ce client"})]})})]})]})]}),e.jsx(V,{isOpen:k,onClose:()=>g(!1),customer:a,onSuccess:()=>p.reload(),canCreate:!1,canUpdate:x})]})}export{ne as default};
