import{u as le,r as h,b as he,j as e,n as c,c as pe,a as P,H as ye}from"./app-BGTsh8B3.js";import{b as S,H as be,a9 as je,I as K,u as Ne,A as ve,m as X,P as Y,aa as V,ab as Z,E as fe,c as ee,ac as O,e as _e}from"./AppLayout-B9W2Qjn-.js";import{C as re,a as ae,b as se,c as te}from"./card-DzyZZsrB.js";import{B as u}from"./Button-Cm51LcKk.js";import{I as p}from"./Input-LVtkliO7.js";import{B}from"./badge-vyxm7s9H.js";import{M as ie}from"./Modal-OSZm3TU8.js";import{D as ke}from"./Drawer-D_RvWb8n.js";import{L as g}from"./Label-CEns7YJb.js";import{T as we}from"./textarea-Dc6vmaOE.js";import{X as $}from"./x-Bqi0sytM.js";import{T as Ce}from"./user-cog-CgPvrrVM.js";import"./createLucideIcon-B4miffV9.js";import"./shield-x-DRqpxde8.js";import"./Dropdown-DbeWMHj2.js";import"./transition-JR3jNvu7.js";import"./arrow-left-BMPE_XAu.js";import"./loader-circle-CIdMfzjo.js";import"./refresh-cw-CA0aJ90x.js";import"./FlashMessages-o0prhkl9.js";const Se=["PIECE","LOT","METRE","KG","LITRE","BOITE","CARTON","UNITE"];function Pe({isOpen:b,onClose:k,product:s=null,categories:H=[]}){const I=!!s,{props:q}=le(),E=q.shop?.currencies||[],T=q.shop?.currency||E.find(a=>a.is_default)?.code||E[0]?.code||"USD",[A,j]=h.useState(s?.image_url||null),{data:t,setData:i,post:L,put:G,processing:w,errors:o,reset:v}=he({name:s?.name||"",product_code:s?.product_code||"",description:s?.description||"",category_id:s?.category_id||"",price:s?.price_amount??"",currency:s?.price_currency||T,minimum_stock:s?.minimum_stock??0,unit:s?.type_unite||"UNITE",type_unite:s?.type_unite||"UNITE",quantite_par_unite:s?.quantite_par_unite??1,est_divisible:s?.est_divisible!==!1,image:null,remove_image:!1,price_normal:s?.price_normal??s?.price_amount??"",price_reduced:s?.price_reduced??"",price_reduction_percent:s?.price_reduction_percent??"",price_non_negotiable:s?.price_non_negotiable??"",price_wholesale_normal:s?.price_wholesale_normal??"",price_wholesale_reduced:s?.price_wholesale_reduced??"",price_non_negotiable_wholesale:s?.price_non_negotiable_wholesale??""}),[z,C]=h.useState(!1);h.useEffect(()=>{s?(i({name:s.name||"",product_code:s.product_code||"",description:s.description||"",category_id:s.category_id||"",price:s.price_amount??"",currency:s.price_currency||T,minimum_stock:s.minimum_stock??0,unit:s.type_unite||"UNITE",type_unite:s.type_unite||"UNITE",quantite_par_unite:s.quantite_par_unite??1,est_divisible:s.est_divisible!==!1,image:null,remove_image:!1,price_normal:s.price_normal??s.price_amount??"",price_reduced:s.price_reduced??"",price_reduction_percent:s.price_reduction_percent??"",price_non_negotiable:s.price_non_negotiable??"",price_wholesale_normal:s.price_wholesale_normal??"",price_wholesale_reduced:s.price_wholesale_reduced??"",price_non_negotiable_wholesale:s.price_non_negotiable_wholesale??""}),j(s.image_url||null)):(v(),j(null))},[s]);const m=a=>{const d=a.target.files?.[0];if(!d)return;if(d.size>2*1024*1024){c.error("L'image ne doit pas dépasser 2 Mo");return}if(!d.type.match(/^image\/(jpeg|jpg|png|webp)$/)){c.error("Format d'image non supporté. Utilisez JPG, PNG ou WebP.");return}i("image",d),i("remove_image",!1);const x=new FileReader;x.onloadend=()=>{j(x.result)},x.readAsDataURL(d)},M=()=>{i("image",null),i("remove_image",!0),j(null)},R=()=>{const a=parseFloat(t.price_normal||t.price)||0,d=parseFloat(t.price_reduction_percent)||0;if(a>0&&d>0){const x=a*(1-d/100);i("price_reduced",x.toFixed(2))}else i("price_reduced","")};h.useEffect(()=>{t.price_reduction_percent&&(t.price_normal||t.price)&&R()},[t.price_normal,t.price,t.price_reduction_percent]);const f=async()=>{if(!t.name){c.error("Veuillez d'abord saisir le nom du produit.");return}try{C(!0);const a=await pe.get(route("hardware.products.generate-code"),{params:{name:t.name}});a.data?.code?(i("product_code",a.data.code),c.success("Code généré")):c.error("Impossible de générer le code")}catch(a){c.error(a.response?.data?.message||"Erreur génération du code")}finally{C(!1)}},l=a=>{a.preventDefault(),i("unit",t.type_unite),!t.price_normal&&t.price&&i("price_normal",t.price),I?G(route("hardware.products.update",s.id),{forceFormData:!0,preserveScroll:!1,onSuccess:()=>{c.success("Produit mis à jour"),k(),v(),j(null),P.reload({only:["products"]})},onError:d=>{const x=d.message||(typeof d=="string"?d:"Erreur lors de la mise à jour");c.error(x)}}):L(route("hardware.products.store"),{forceFormData:!0,preserveScroll:!1,onSuccess:()=>{c.success("Produit créé"),k(),v(),j(null),P.reload({only:["products"]})},onError:d=>{const x=d.message||(typeof d=="string"?d:"Erreur lors de la création");c.error(x)}})};return e.jsx(ke,{isOpen:b,onClose:()=>{v(),k()},title:I?"Modifier le produit":"Nouveau produit",size:"xl",children:e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(S,{className:"h-5 w-5 mr-2"})," Informations produit"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"name",children:"Nom *"}),e.jsx(p,{id:"name",value:t.name,onChange:a=>i("name",a.target.value),placeholder:"Nom du produit",required:!0}),o.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"product_code",children:"Code produit *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(be,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(p,{id:"product_code",value:t.product_code,onChange:a=>i("product_code",a.target.value),className:"pl-10",placeholder:"ex: VIS-001",required:!0})]}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:f,disabled:z,children:[e.jsx(je,{className:"h-4 w-4 mr-1"})," ",z?"...":"Auto"]})]}),o.product_code&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.product_code})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"description",children:"Description"}),e.jsx(we,{id:"description",value:t.description,onChange:a=>i("description",a.target.value),rows:3,placeholder:"Description..."}),o.description&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"image",children:"Image du produit"}),e.jsxs("div",{className:"flex items-center gap-4",children:[A?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:A,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border border-gray-300 dark:border-gray-600"}),e.jsx("button",{type:"button",onClick:M,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10",title:"Supprimer l'image",children:e.jsx($,{className:"h-3 w-3"})}),e.jsx("label",{htmlFor:"image",className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 group-hover:bg-opacity-50 rounded-lg cursor-pointer transition-all",title:"Remplacer l'image",children:e.jsx(K,{className:"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]}):e.jsxs("label",{htmlFor:"image",className:"flex flex-col items-center justify-center w-24 h-24 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:border-amber-500 transition-colors",children:[e.jsx(K,{className:"h-6 w-6 text-gray-400 mb-1"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Image"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",id:"image",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:m,className:"hidden"}),A&&e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 mb-1",children:"Cliquez sur l'image pour la remplacer"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"JPG, PNG, WebP (max 2 Mo)"})]})]}),o.image&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.image})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"category_id",children:"Catégorie *"}),e.jsxs("select",{id:"category_id",value:t.category_id,onChange:a=>i("category_id",a.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-amber-500 focus:ring-amber-500",required:!0,children:[e.jsx("option",{value:"",children:"— Choisir —"}),H.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),o.category_id&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.category_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price",children:"Prix principal *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{id:"price",type:"number",step:"0.01",min:"0",value:t.price,onChange:a=>{i("price",a.target.value),t.price_normal||i("price_normal",a.target.value)},placeholder:"0.00",required:!0}),e.jsx("select",{value:t.currency,onChange:a=>i("currency",a.target.value),className:"rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white w-24",children:E.length>0?E.map(a=>e.jsx("option",{value:a.code,children:a.code},a.code)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"CDF",children:"CDF"}),e.jsx("option",{value:"EUR",children:"EUR"})]})})]}),o.price&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.price})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"type_unite",children:"Unité"}),e.jsx("select",{id:"type_unite",value:t.type_unite,onChange:a=>{const d=a.target.value;i("type_unite",d),i("unit",d)},className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:border-amber-500 focus:ring-amber-500",children:Se.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"quantite_par_unite",children:"Quantité par unité"}),e.jsx(p,{id:"quantite_par_unite",type:"number",min:1,value:t.quantite_par_unite,onChange:a=>i("quantite_par_unite",a.target.value)}),o.quantite_par_unite&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.quantite_par_unite})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"minimum_stock",children:"Stock minimum"}),e.jsx(p,{id:"minimum_stock",type:"number",min:0,value:t.minimum_stock,onChange:a=>i("minimum_stock",a.target.value)}),o.minimum_stock&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:o.minimum_stock})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"est_divisible",checked:t.est_divisible,onChange:a=>i("est_divisible",a.target.checked),className:"rounded border-gray-300 text-amber-600 focus:ring-amber-500 dark:border-gray-600 dark:bg-gray-700"}),e.jsx(g,{htmlFor:"est_divisible",children:"Vente en fraction autorisée"})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Gestion des prix"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2",children:"Prix de vente au détail"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price_normal",children:"Prix normal"}),e.jsx(p,{id:"price_normal",type:"number",step:"0.01",min:0,value:t.price_normal,onChange:a=>i("price_normal",a.target.value),placeholder:"Prix normal"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price_reduction_percent",children:"Pourcentage de réduction (%)"}),e.jsx(p,{id:"price_reduction_percent",type:"number",step:"0.01",min:0,max:100,value:t.price_reduction_percent,onChange:a=>{i("price_reduction_percent",a.target.value),R()},placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price_reduced",children:"Prix réduit (calculé)"}),e.jsx(p,{id:"price_reduced",type:"number",step:"0.01",min:0,value:t.price_reduced,onChange:a=>i("price_reduced",a.target.value),placeholder:"Prix réduit",readOnly:!!t.price_reduction_percent})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price_non_negotiable",children:"Prix non discutable (détail)"}),e.jsx(p,{id:"price_non_negotiable",type:"number",step:"0.01",min:0,value:t.price_non_negotiable,onChange:a=>i("price_non_negotiable",a.target.value),placeholder:"Ex: 5.00"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Prix minimum de vente au détail (non négociable)"})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2",children:"Prix de vente en gros"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price_wholesale_normal",children:"Prix gros normal"}),e.jsx(p,{id:"price_wholesale_normal",type:"number",step:"0.01",min:0,value:t.price_wholesale_normal,onChange:a=>i("price_wholesale_normal",a.target.value),placeholder:"Prix gros normal"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price_wholesale_reduced",children:"Prix gros réduit"}),e.jsx(p,{id:"price_wholesale_reduced",type:"number",step:"0.01",min:0,value:t.price_wholesale_reduced,onChange:a=>i("price_wholesale_reduced",a.target.value),placeholder:"Prix gros réduit"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"price_non_negotiable_wholesale",children:"Prix non discutable (gros)"}),e.jsx(p,{id:"price_non_negotiable_wholesale",type:"number",step:"0.01",min:0,value:t.price_non_negotiable_wholesale,onChange:a=>i("price_non_negotiable_wholesale",a.target.value),placeholder:"Ex: 4.50"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Prix minimum de vente en gros (non négociable)"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:k,disabled:w,children:[e.jsx($,{className:"h-4 w-4 mr-2"})," Annuler"]}),e.jsxs(u,{type:"submit",className:"bg-amber-500 dark:bg-amber-600 text-white hover:bg-amber-600 dark:hover:bg-amber-700",disabled:w,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"})," ",w?"Enregistrement...":I?"Enregistrer":"Créer"]})]})]})})}function Ke({products:b=[],categories:k=[],filters:s={},canImport:H=!1,depots:I=[]}){const{props:q}=le(),E=q.depots||I||[],[T,A]=h.useState(s?.search||""),[j,t]=h.useState(s?.category_id||""),[i,L]=h.useState(s?.status||""),[G,w]=h.useState(!1),[o,v]=h.useState(null),[z,C]=h.useState(!1),[m,M]=h.useState(null),[R,f]=h.useState(!1),[l,a]=h.useState(null),[d,x]=h.useState(""),[N,D]=h.useState([]),[F,U]=h.useState(!1),de=r=>{r.preventDefault(),P.get(route("hardware.products"),{search:T,category_id:j,status:i||void 0})},W=()=>{v(null),w(!0)},Q=r=>{v(r),w(!0)},ne=r=>{M(r),C(!0)},ce=r=>{D(n=>n.some(_=>_.id===r.id)?n.filter(_=>_.id!==r.id):[...n,r])},oe=()=>{N.length===b.length?D([]):D([...b])},J=r=>{if(r)a([r]);else{if(N.length===0){c.error("Veuillez sélectionner au moins un produit");return}a(N)}x(""),f(!0)},me=async()=>{if(!d){c.error("Veuillez sélectionner un dépôt de destination");return}if(!l||l.length===0){c.error("Aucun produit sélectionné");return}if(l.length===1)P.post(route("hardware.products.duplicate-to-depot",l[0].id),{target_depot_id:d},{preserveScroll:!1,onSuccess:()=>{c.success("Produit dupliqué avec succès"),f(!1),a(null),x(""),D([]),U(!1)},onError:r=>{const n=r?.message||(typeof r=="string"?r:"Erreur lors de la duplication");c.error(n)}});else{let r=0,n=0;for(const y of l)try{await new Promise((_,Ee)=>{P.post(route("hardware.products.duplicate-to-depot",y.id),{target_depot_id:d},{preserveScroll:!1,only:[],onSuccess:()=>{r++,_()},onError:ue=>{n++,console.error("Error duplicating product:",y.id,ue),_()}})})}catch(_){n++,console.error("Error duplicating product:",y.id,_)}r>0&&c.success(`${r} produit${r>1?"s":""} dupliqué${r>1?"s":""} avec succès`),n>0&&c.error(`${n} produit${n>1?"s":""} n'a${n>1?"ont":""} pas pu être dupliqué${n>1?"s":""}`),f(!1),a(null),x(""),D([]),U(!1),P.reload({only:["products"]})}},xe=r=>{c.custom(n=>e.jsx("div",{className:`${n.visible?"animate-enter":"animate-leave"} max-w-md w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5`,children:e.jsxs("div",{className:"flex-1 w-0 p-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(_e,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Confirmer la suppression"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:['Êtes-vous sûr de vouloir supprimer "',r.name,'" ? Cette action est irréversible.']})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{c.dismiss(n.id),P.delete(route("hardware.products.destroy",r.id),{preserveScroll:!0,onSuccess:()=>c.success("Produit supprimé"),onError:y=>c.error(y?.message||"Erreur")})},className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-red-700 transition",children:"Supprimer"}),e.jsx("button",{onClick:()=>c.dismiss(n.id),className:"flex-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition",children:"Annuler"})]})]})}),{duration:1/0})},ge=r=>{const n=r.current_stock??0,y=r.minimum_stock??0;return n<=0?e.jsx(B,{variant:"destructive",children:"Rupture"}):n<=y?e.jsx(B,{variant:"warning",children:"Stock bas"}):e.jsx(B,{variant:"success",children:"En stock"})};return e.jsxs(ve,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:"Produits — Quincaillerie"}),e.jsxs("div",{className:"flex gap-2",children:[F&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:"outline",onClick:()=>{N.length>0?J(null):c.error("Veuillez sélectionner au moins un produit")},disabled:N.length===0,className:"border-amber-500 text-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20 dark:border-amber-600 dark:text-amber-400",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Dupliquer (",N.length,")"]}),e.jsx(u,{variant:"outline",onClick:()=>{U(!1),D([])},className:"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",children:"Annuler"})]}),!F&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:"outline",onClick:()=>U(!0),className:"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Sélectionner"]}),e.jsxs(u,{onClick:W,className:"bg-amber-500 hover:bg-amber-600 text-white",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Ajouter un produit"}),e.jsx("span",{className:"sm:hidden",children:"Ajouter"})]})]})]})]}),children:[e.jsx(ye,{title:"Produits - Quincaillerie"}),e.jsxs("div",{className:"py-6 space-y-6",children:[e.jsxs(re,{className:"mb-6 bg-white dark:bg-gray-800",children:[e.jsx(ae,{children:e.jsxs(se,{className:"flex items-center text-gray-900 dark:text-white",children:[e.jsx(X,{className:"h-5 w-5 mr-2"})," Recherche"]})}),e.jsx(te,{children:e.jsxs("form",{onSubmit:de,className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(p,{placeholder:"Rechercher par nom ou code...",value:T,onChange:r=>A(r.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-amber-500 focus:ring-amber-500",value:j,onChange:r=>t(r.target.value),children:[e.jsx("option",{value:"",children:"Toutes les catégories"}),k.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-amber-500 focus:ring-amber-500",value:i,onChange:r=>L(r.target.value),children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"active",children:"Actif"}),e.jsx("option",{value:"inactive",children:"Inactif"})]})}),e.jsxs(u,{type:"submit",children:[e.jsx(X,{className:"h-4 w-4 mr-2"})," Rechercher"]})]})})]}),e.jsxs(re,{className:"bg-white dark:bg-gray-800",children:[e.jsx(ae,{children:e.jsxs(se,{className:"flex items-center text-gray-900 dark:text-white",children:[e.jsx(S,{className:"h-5 w-5 mr-2"})," Liste des produits (",b.length,")"]})}),e.jsx(te,{children:b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"h-12 w-12 mx-auto text-gray-400 dark:text-gray-500 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucun produit"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Créez votre premier produit."}),e.jsxs(u,{onClick:W,className:"bg-amber-500 hover:bg-amber-600 text-white",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"})," Ajouter un produit"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[F&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:e.jsx("button",{onClick:oe,className:"flex items-center hover:opacity-80 transition-opacity",title:N.length===b.length?"Désélectionner tout":"Sélectionner tout",children:N.length===b.length?e.jsx(V,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}):e.jsx(Z,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"})})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Produit"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Catégorie"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Prix"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Statut"}),!F&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:b.map(r=>{const n=N.some(y=>y.id===r.id);return e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${n?"bg-amber-50 dark:bg-amber-900/20":""}`,children:[F&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>ce(r),className:"flex items-center",children:n?e.jsx(V,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}):e.jsx(Z,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center overflow-hidden relative",children:r.image_url?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:r.image_url,alt:r.name,className:"h-full w-full object-cover",onError:y=>{y.target.style.display="none"}}),e.jsx(S,{className:"h-6 w-6 text-gray-400 absolute inset-0 m-auto",style:{display:"none"}})]}):e.jsx(S,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r.name}),r.description&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:r.description})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:r.product_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:r.category?.name||"—"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[r.price_currency," ",Number(r.price_amount).toFixed(2)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[e.jsx("span",{className:"font-medium",children:r.current_stock}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[" / ",r.minimum_stock]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ge(r)}),!F&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>ne(r),title:"Voir",children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>Q(r),title:"Modifier",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>J(r),title:"Dupliquer vers un autre dépôt",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(u,{variant:"destructive",size:"sm",onClick:()=>xe(r),children:e.jsx(Ce,{className:"h-4 w-4"})})]})})]},r.id)})})]})})})]})]}),e.jsx(ie,{show:R,onClose:()=>{f(!1),a(null),x("")},maxWidth:"md",className:"bg-white dark:bg-gray-800",children:e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6 border-b border-gray-200 dark:border-gray-700 pb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-amber-500"}),l&&l.length>1?"Dupliquer les produits":"Dupliquer le produit"]}),l&&l.length>1&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[l.length," produit",l.length>1?"s":""," sélectionné",l.length>1?"s":""]})]}),e.jsx("button",{type:"button",onClick:()=>{f(!1),a(null),x("")},className:"rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx($,{className:"h-5 w-5"})})]}),l&&l.length>0&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:["Produit",l.length>1?"s":""," à dupliquer :"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:l.map(r=>e.jsx("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:r.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Code : ",r.product_code]})]})},r.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"target_depot",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Dépôt de destination ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"target_depot",value:d,onChange:r=>x(r.target.value),className:"w-full h-10 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[e.jsx("option",{value:"",className:"bg-white dark:bg-gray-700",children:"Sélectionner un dépôt"}),E.filter(r=>r.id!==q?.currentDepot?.id).map(r=>e.jsxs("option",{value:r.id,className:"bg-white dark:bg-gray-700",children:[r.name," ",r.code?`(${r.code})`:""]},r.id))]})]}),e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:[e.jsx("strong",{className:"font-semibold",children:"Note :"})," Le",l.length>1?"s":""," produit",l.length>1?"s":""," sera",l.length>1?"ont":""," dupliqué",l.length>1?"s":""," avec tous ",l.length>1?"leurs":"ses"," prix, mais le stock sera initialisé à 0."]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(u,{variant:"outline",onClick:()=>{f(!1),a(null),x("")},className:"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Annuler"}),e.jsxs(u,{onClick:me,disabled:!d,className:"bg-amber-500 hover:bg-amber-600 dark:bg-amber-600 dark:hover:bg-amber-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Dupliquer ",l.length>1?`(${l.length})`:""]})]})]})]})}),e.jsx(ie,{show:z,onClose:()=>{C(!1),M(null)},maxWidth:"xl",className:"bg-white dark:bg-gray-800",children:m&&e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6 border-b border-gray-200 dark:border-gray-700 pb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-amber-500"}),"Détail du produit"]}),e.jsx("button",{type:"button",onClick:()=>C(!1),className:"rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx($,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-shrink-0 h-32 w-32 rounded-lg bg-gray-100 dark:bg-gray-700/50 border border-gray-200 dark:border-gray-600 flex items-center justify-center overflow-hidden",children:[m.image_url?e.jsx("img",{src:m.image_url,alt:m.name,className:"h-full w-full object-cover",onError:r=>{r.target.style.display="none",r.target.nextSibling.style.display="flex"}}):null,e.jsx(S,{className:"h-16 w-16 text-gray-400 dark:text-gray-500",style:{display:m.image_url?"none":"flex"}})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Nom"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold mt-1",children:m.name})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Code"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-medium mt-1",children:m.product_code})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Catégorie"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-medium mt-1",children:m.category?.name||"—"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Prix"}),e.jsxs("p",{className:"text-gray-900 dark:text-white font-semibold mt-1",children:[m.price_currency," ",Number(m.price_amount).toFixed(2)]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Stock actuel"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold mt-1",children:m.current_stock})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Stock minimum"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-medium mt-1",children:m.minimum_stock})]})]}),m.description&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Description"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-1",children:m.description})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>{C(!1),Q(m)},className:"border-amber-500 text-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"})," Modifier"]})})]})]})]})}),e.jsx(Pe,{isOpen:G,onClose:()=>{w(!1),v(null)},product:o,categories:k})]})}export{Ke as default};
