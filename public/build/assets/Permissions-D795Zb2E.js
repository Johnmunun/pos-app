import{u as f,r as d,n as c,j as e,H as v,a as i}from"./app-3PKVeuQh.js";import{A as k}from"./AppLayout-DSrKCpOy.js";import{R as m}from"./refresh-cw-L3GUbwVE.js";import"./createLucideIcon-CyiEew_u.js";import"./shield-x-gOy17OJ-.js";import"./x-YL0zAneP.js";import"./user-cog-nVqfHm0b.js";import"./Dropdown-B_QkibTR.js";import"./transition-CufTvwOt.js";import"./arrow-left-CvJq81LS.js";import"./loader-circle-D2tkCN5O.js";import"./FlashMessages-bPB7K-Ql.js";function _(){const{permissions:l,search:p,flash:a}=f().props,[x,u]=d.useState(p||""),[g,o]=d.useState(null),[h,n]=d.useState(!1);d.useEffect(()=>{a?.message&&c.success(a.message),a?.error&&c.error(a.error)},[a?.message,a?.error]);const y=r=>{r.preventDefault(),i.get("/admin/access-manager/permissions",{search:x},{preserveState:!0,preserveScroll:!0})},b=r=>{i.delete(`/admin/access-manager/permissions/${r}`,{preserveScroll:!0,onSuccess:()=>o(null)})},j=()=>{n(!0),i.post("/admin/access-manager/permissions/sync",{},{preserveScroll:!0,onSuccess:()=>{i.reload({only:["permissions"],preserveScroll:!0}),n(!1)},onError:r=>{const t=r.message||r.default||"Erreur inconnue lors de la synchronisation";c.error("Erreur: "+t),n(!1)},onFinish:()=>n(!1)})};return e.jsxs(k,{header:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold leading-tight text-gray-900 dark:text-white",children:"Gestion des Permissions"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[Object.values(l).flat().length," permission",Object.values(l).flat().length>1?"s":""," au total"]})]}),e.jsx("button",{onClick:j,disabled:h,className:"inline-flex items-center gap-2 px-3 sm:px-4 py-2 bg-amber-600 hover:bg-amber-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors shrink-0","aria-label":"Générer depuis permissions.yaml",children:h?e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{className:"hidden md:inline",children:"Synchronisation..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden lg:inline",children:"Générer depuis permissions.yaml"})]})})]}),children:[e.jsx(v,{title:"Gestion des Permissions"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:y,className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:x,onChange:r=>u(r.target.value),placeholder:"Rechercher une permission...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent"})}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium",children:"Rechercher"})]})}),Object.keys(l).length===0?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucune permission trouvée"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-end mb-4",children:e.jsxs("button",{onClick:()=>i.reload({only:["permissions"]}),className:"inline-flex items-center gap-2 px-3 py-1.5 text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition",title:"Actualiser la liste",children:[e.jsx(m,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Actualiser"})]})}),Object.entries(l).map(([r,t])=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r||"Sans groupe"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[t.length," permission",t.length>1?"s":""]})]}),e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:t.map(s=>e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.code}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.roles_count||0," rôle",s.roles_count!==1?"s":""]}),e.jsx("button",{onClick:()=>o(s.id),className:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 text-sm font-medium",children:"Supprimer"})]})]},s.id))})]},r))]})]})}),g&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full mx-4 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirmer la suppression"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6",children:"Êtes-vous sûr de vouloir supprimer cette permission ? Cette action est irréversible."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>o(null),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Annuler"}),e.jsx("button",{onClick:()=>b(g),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors",children:"Supprimer"})]})]})})]})}export{_ as default};
