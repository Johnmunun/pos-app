import{u as O,r as i,b as U,j as e,H as X,a as k}from"./app-DtqU_Gmt.js";import{A as q,D as J,F as K,l as Q,m as V,C as W,P as A}from"./AppLayout-C4K4I5xd.js";import{C as f,a as w,b as C,c as S}from"./card-Daek165Z.js";import{B as l}from"./Button-4k-pObky.js";import{I as n}from"./Input-BpgKxISb.js";import{L as s}from"./Label-QVyen-Zj.js";import{B as F}from"./badge-BBdevRdg.js";import{f as Y}from"./currency-CAle3Gff.js";import"./createLucideIcon-BH-qXF_i.js";import"./shield-x-Cz4kXV9c.js";import"./x-Cw-ZD_Fb.js";import"./user-cog-BQwjoD4w.js";import"./Dropdown--z3bvfF1.js";import"./transition-DbHxI3Hw.js";import"./arrow-left-BGTcItEv.js";import"./loader-circle-DtoZnQ6b.js";import"./refresh-cw-CcjnuCLI.js";import"./FlashMessages-D-g4FpAa.js";import"./utils-CDN07tui.js";const _=[{value:"",label:"Toutes les catégories"},{value:"stock_purchase",label:"Achat stock"},{value:"transport",label:"Transport"},{value:"salary",label:"Salaire"},{value:"fixed_charge",label:"Charge fixe"},{value:"utilities",label:"Services (eau, électricité...)"},{value:"maintenance",label:"Maintenance"},{value:"other",label:"Autres"}],Z=[{value:"",label:"Tous les statuts"},{value:"pending",label:"En attente"},{value:"approved",label:"Approuvée"},{value:"rejected",label:"Rejetée"}];function be({expenses:x=[],filters:a={},pagination:m}){const{shop:P}=O().props,D=P?.currency||"CDF",[g,u]=i.useState(a.category||""),[p,h]=i.useState(a.status||""),[y,b]=i.useState(a.from||""),[j,v]=i.useState(a.to||"");i.useEffect(()=>{u(a.category||""),h(a.status||""),b(a.from||""),v(a.to||"")},[a.category,a.status,a.from,a.to]);const T=t=>{t.preventDefault(),k.get(route("finance.expenses.index"),{category:g||void 0,status:p||void 0,from:y||void 0,to:j||void 0,page:1},{preserveState:!0})},B=()=>{u(""),h(""),b(""),v(""),k.get(route("finance.expenses.index"),{},{preserveState:!1})},{data:o,setData:c,post:I,processing:L,errors:r,reset:R}=U({amount:"",currency:D,category:"",description:"",supplier_id:"",attachment_path:""}),H=t=>{t.preventDefault(),I(route("finance.expenses.store"),{onSuccess:()=>{R()}})},M=t=>Y(t||0,D),z=t=>t==="approved"?e.jsx(F,{className:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/40 dark:text-emerald-300 text-xs",children:"Approuvée"}):t==="rejected"?e.jsx(F,{className:"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300 text-xs",children:"Rejetée"}):e.jsx(F,{className:"bg-amber-100 text-amber-800 dark:bg-amber-900/40 dark:text-amber-300 text-xs",children:"En attente"}),d=m?.current_page??1,N=m?.last_page??1,E=t=>{k.get(route("finance.expenses.index"),{...a,page:t},{preserveState:!0})};return e.jsxs(q,{children:[e.jsx(X,{title:"Dépenses"}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[e.jsx(J,{className:"h-6 w-6 text-emerald-500"}),"Gestion des Dépenses"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Suivi des dépenses par catégorie, période et statut."})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(l,{type:"button",variant:"outline",onClick:()=>window.open(route("finance.expenses.export.pdf",{category:g||void 0,status:p||void 0,from:y||void 0,to:j||void 0}),"_blank","noopener,noreferrer"),className:"border-gray-300 dark:border-slate-600",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Export PDF"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs(f,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsx(w,{children:e.jsxs(C,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[e.jsx(Q,{className:"h-5 w-5 text-emerald-500"}),"Filtres"]})}),e.jsx(S,{children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"category",className:"text-gray-700 dark:text-gray-300",children:"Catégorie"}),e.jsx("select",{id:"category",value:g,onChange:t=>u(t.target.value),className:"mt-1 w-full h-10 rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-emerald-500",children:_.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"status",className:"text-gray-700 dark:text-gray-300",children:"Statut"}),e.jsx("select",{id:"status",value:p,onChange:t=>h(t.target.value),className:"mt-1 w-full h-10 rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-emerald-500",children:Z.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"from",className:"text-gray-700 dark:text-gray-300",children:"Du"}),e.jsx(n,{id:"from",type:"date",value:y,onChange:t=>b(t.target.value),className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"to",className:"text-gray-700 dark:text-gray-300",children:"Au"}),e.jsx(n,{id:"to",type:"date",value:j,onChange:t=>v(t.target.value),className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-gray-100"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{type:"submit",className:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Filtrer"]}),e.jsx(l,{type:"button",variant:"outline",onClick:B,className:"border-gray-300 dark:border-slate-600",children:e.jsx(W,{className:"h-4 w-4"})})]})]})})]}),e.jsxs(f,{className:"lg:col-span-2 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsx(w,{children:e.jsxs(C,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[e.jsx(A,{className:"h-5 w-5 text-emerald-500"}),"Enregistrer une dépense"]})}),e.jsx(S,{children:e.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"amount",className:"text-gray-700 dark:text-gray-300",children:"Montant"}),e.jsx(n,{id:"amount",type:"number",step:"0.01",value:o.amount,onChange:t=>c("amount",t.target.value),className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-gray-100"}),r.amount&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:r.amount})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"category_create",className:"text-gray-700 dark:text-gray-300",children:"Catégorie"}),e.jsxs("select",{id:"category_create",value:o.category,onChange:t=>c("category",t.target.value),className:"mt-1 w-full h-10 rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[e.jsx("option",{value:"",children:"Sélectionner"}),_.filter(t=>t.value).map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),r.category&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:r.category})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"description",className:"text-gray-700 dark:text-gray-300",children:"Description"}),e.jsx(n,{id:"description",value:o.description,onChange:t=>c("description",t.target.value),className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-gray-100"}),r.description&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:r.description})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"supplier_id",className:"text-gray-700 dark:text-gray-300",children:"Fournisseur (optionnel)"}),e.jsx(n,{id:"supplier_id",value:o.supplier_id,onChange:t=>c("supplier_id",t.target.value),className:"mt-1 bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-gray-100"}),r.supplier_id&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:r.supplier_id})]}),e.jsx("div",{className:"md:col-span-2 flex justify-end",children:e.jsxs(l,{type:"submit",disabled:L,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Enregistrer"]})})]})})]})]}),e.jsxs(f,{className:"mt-6 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsx(w,{children:e.jsx(C,{className:"flex items-center justify-between text-gray-900 dark:text-gray-100",children:e.jsxs("span",{children:["Liste des dépenses (",m?.total??x.length,")"]})})}),e.jsxs(S,{children:[x.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Aucune dépense trouvée pour les filtres sélectionnés."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 dark:text-gray-400 border-b border-gray-200 dark:border-slate-700",children:[e.jsx("th",{className:"py-2 pr-4",children:"Date"}),e.jsx("th",{className:"py-2 pr-4",children:"Catégorie"}),e.jsx("th",{className:"py-2 pr-4",children:"Description"}),e.jsx("th",{className:"py-2 pr-4 text-right",children:"Montant"}),e.jsx("th",{className:"py-2 pr-4 text-center",children:"Statut"})]})}),e.jsx("tbody",{children:x.map(t=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-slate-800",children:[e.jsx("td",{className:"py-2 pr-4 text-gray-900 dark:text-gray-100",children:t.created_at?.slice(0,16)||""}),e.jsx("td",{className:"py-2 pr-4 text-gray-900 dark:text-gray-100",children:_.find(G=>G.value===t.category)?.label||t.category}),e.jsx("td",{className:"py-2 pr-4 text-gray-900 dark:text-gray-100",children:t.description||"-"}),e.jsx("td",{className:"py-2 pr-4 text-right text-gray-900 dark:text-gray-100",children:M(t.amount)}),e.jsx("td",{className:"py-2 pr-4 text-center",children:z(t.status)})]},t.id))})]})}),N>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{children:["Page ",d," sur ",N]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{type:"button",variant:"outline",size:"sm",disabled:d<=1,onClick:()=>E(d-1),children:"Précédent"}),e.jsx(l,{type:"button",variant:"outline",size:"sm",disabled:d>=N,onClick:()=>E(d+1),children:"Suivant"})]})]})]})]})]})]})}export{be as default};
