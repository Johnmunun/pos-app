import{u as $,r as i,j as e,H as J,L as K,a as m,z as h,c as Q}from"./app-DZtTOeIE.js";import{A as W,x as A,C as E,P as b,F as Y,h as Z,O as ee,i as ae,M as te,E as se,c as re}from"./AppLayout-Bwi93PbD.js";import{C as d,a as c,b as n,c as x}from"./card-vlabImcc.js";import{B as r}from"./Button-BTh3B2Uw.js";import{I as le}from"./Input--MgEb_Nf.js";import{B as F}from"./badge-BDQ0rHun.js";import{S as ie}from"./SupplierDrawer-DNMuA8UP.js";import{E as de}from"./ExportButtons-l3zvJHrk.js";import{C as _,U as ce}from"./x-CXs6YGQp.js";import"./createLucideIcon-CC-qNPM4.js";import"./shield-x-BMsLrHBM.js";import"./user-cog-HidSeQFU.js";import"./Dropdown-BcljNwe3.js";import"./transition-DLc2G3IG.js";import"./arrow-left-B06KhL06.js";import"./loader-circle-DAnXRmQH.js";import"./refresh-cw-BgZ2dbVR.js";import"./FlashMessages-DVzYx1sH.js";import"./Drawer-DwT_q8h7.js";import"./Label-CgyD4LXG.js";import"./textarea-JCPRrjpX.js";function Fe({suppliers:t,filters:g={}}){const{auth:z}=$().props,j=z?.permissions||[],[f,B]=i.useState(g.search||""),[N,I]=i.useState(g.status||""),[k,T]=i.useState(g.per_page||15),[v,w]=i.useState({}),[L,u]=i.useState(!1),[O,p]=i.useState(null),l=a=>j.includes("*")?!0:a.split("|").some(o=>j.includes(o)),y=l("pharmacy.supplier.create"),C=l("pharmacy.supplier.edit"),U=l("pharmacy.supplier.view"),D=a=>{a.preventDefault(),m.get(route("pharmacy.suppliers.index"),{search:f||void 0,status:N||void 0,per_page:k||void 0},{preserveState:!0})},S=()=>{p(null),u(!0)},H=a=>{p(a),u(!0)},M=()=>{u(!1),p(null)},R=()=>{m.reload({only:["suppliers"]})},P=async a=>{const o=a.status==="active"?"deactivate":"activate",X=a.status==="active"?"pharmacy.supplier.deactivate":"pharmacy.supplier.activate";if(!l(X)){h.error("Vous n'avez pas la permission pour cette action.");return}w(s=>({...s,[a.id]:!0}));try{const s=await Q.post(route(`pharmacy.suppliers.${o}`,a.id));s.data.success?(h.success(s.data.message),m.reload({only:["suppliers"]})):h.error(s.data.message)}catch{h.error("Une erreur est survenue.")}finally{w(s=>({...s,[a.id]:!1}))}},V=a=>a==="active"?e.jsx(F,{className:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:"Actif"}):e.jsx(F,{className:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:"Inactif"}),q=t.data?.filter(a=>a.status==="active").length||0,G=t.data?.filter(a=>a.status==="inactive").length||0;return e.jsxs(W,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-100 leading-tight",children:"Gestion des Fournisseurs"}),children:[e.jsx(J,{title:"Fournisseurs"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(d,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Total Fournisseurs"}),e.jsx(A,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.total||0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"enregistrés"})]})]}),e.jsxs(d,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Actifs"}),e.jsx(_,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:q}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"fournisseurs actifs"})]})]}),e.jsxs(d,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Inactifs"}),e.jsx(E,{className:"h-4 w-4 text-gray-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:G}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"fournisseurs inactifs"})]})]}),y&&e.jsxs(d,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Action rapide"}),e.jsx(b,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(x,{children:e.jsxs(r,{onClick:S,className:"w-full bg-amber-500 hover:bg-amber-600 text-white inline-flex items-center justify-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:"Nouveau fournisseur"})]})})]})]}),e.jsxs(d,{className:"mb-6 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between",children:[e.jsxs(n,{className:"flex items-center text-gray-900 dark:text-white",children:[e.jsx(Y,{className:"h-5 w-5 mr-2 text-amber-500"}),"Filtres"]}),e.jsx(de,{pdfUrl:route("pharmacy.exports.suppliers.pdf"),excelUrl:route("pharmacy.exports.suppliers.excel"),disabled:!t.data?.length})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:D,className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Recherche"}),e.jsx(le,{type:"text",value:f,onChange:a=>B(a.target.value),placeholder:"Nom, contact, email, téléphone...",className:"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Statut"}),e.jsxs("select",{className:"h-10 rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-amber-500",value:N,onChange:a=>I(a.target.value),children:[e.jsx("option",{value:"",children:"Tous"}),e.jsx("option",{value:"active",children:"Actifs"}),e.jsx("option",{value:"inactive",children:"Inactifs"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Par page"}),e.jsxs("select",{className:"h-10 rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-amber-500",value:k,onChange:a=>T(a.target.value),children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"})]})]}),e.jsxs(r,{type:"submit",className:"bg-amber-500 hover:bg-amber-600 text-white inline-flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:"Filtrer"})]})]})})]}),e.jsxs(d,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsx(c,{children:e.jsxs(n,{className:"flex items-center text-gray-900 dark:text-white",children:[e.jsx(ce,{className:"h-5 w-5 mr-2 text-blue-500"}),"Liste des fournisseurs (",t.total||0,")"]})}),e.jsx(x,{children:!t.data||t.data.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(A,{className:"h-12 w-12 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Aucun fournisseur trouvé."}),y&&e.jsxs(r,{onClick:S,className:"bg-amber-500 hover:bg-amber-600 text-white inline-flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:"Créer un fournisseur"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Nom"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Téléphone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Commandes"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-slate-700",children:t.data.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center",children:e.jsx(ee,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.name}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Créé le ",a.created_at]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300",children:a.contact_person||"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.phone?e.jsxs("span",{className:"inline-flex items-center text-sm text-gray-700 dark:text-gray-300",children:[e.jsx(ae,{className:"h-3 w-3 mr-1 text-gray-400"}),a.phone]}):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.email?e.jsxs("span",{className:"inline-flex items-center text-sm text-gray-700 dark:text-gray-300",children:[e.jsx(te,{className:"h-3 w-3 mr-1 text-gray-400"}),a.email]}):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",children:a.total_orders})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:V(a.status)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right space-x-2",children:[U&&e.jsx(r,{variant:"outline",size:"sm",asChild:!0,className:"border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700",children:e.jsx(K,{href:route("pharmacy.suppliers.show",a.id),children:e.jsx(se,{className:"h-4 w-4"})})}),C&&e.jsx(r,{variant:"outline",size:"sm",onClick:()=>H(a),className:"border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700",children:e.jsx(re,{className:"h-4 w-4"})}),a.status==="active"&&l("pharmacy.supplier.deactivate")&&e.jsx(r,{variant:"outline",size:"sm",onClick:()=>P(a),disabled:v[a.id],className:"border-orange-300 dark:border-orange-600 text-orange-700 dark:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20",children:e.jsx(E,{className:"h-4 w-4"})}),a.status==="inactive"&&l("pharmacy.supplier.activate")&&e.jsx(r,{variant:"outline",size:"sm",onClick:()=>P(a),disabled:v[a.id],className:"border-green-300 dark:border-green-600 text-green-700 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20",children:e.jsx(_,{className:"h-4 w-4"})})]})]},a.id))})]})}),t.links&&t.links.length>3&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200 dark:border-slate-700",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Affichage de ",t.from," à ",t.to," sur ",t.total," résultats"]}),e.jsx("div",{className:"flex gap-1",children:t.links.map((a,o)=>e.jsx(r,{variant:a.active?"default":"outline",size:"sm",disabled:!a.url,onClick:()=>a.url&&m.get(a.url),className:a.active?"bg-amber-500 hover:bg-amber-600 text-white":"border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-200",dangerouslySetInnerHTML:{__html:a.label}},o))})]})]})})]})]})}),e.jsx(ie,{isOpen:L,onClose:M,supplier:O,onSuccess:R,canCreate:y,canUpdate:C})]})}export{Fe as default};
