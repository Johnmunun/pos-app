import{u as H,R as g,j as e,H as M,L as Q,a as N}from"./app-BGTsh8B3.js";import{P as Y,d as q,b as h,n as P,h as R,o as z,p as b,T as S,A as X,e as v,D as Z,i as G,Z as W}from"./AppLayout-B9W2Qjn-.js";import{C as l,a as o,b as d,c as i}from"./card-DzyZZsrB.js";import{B as C}from"./Button-Cm51LcKk.js";import{f as J}from"./currency-CAle3Gff.js";import{U as F}from"./x-Bqi0sytM.js";import{R as A,L as ee,C as re,X as ae,Y as te,T as D,a as se,P as le,b as oe,c as de,d as ie}from"./PieChart-BGEI3-Mj.js";import"./createLucideIcon-B4miffV9.js";import"./shield-x-DRqpxde8.js";import"./user-cog-CgPvrrVM.js";import"./Dropdown-DbeWMHj2.js";import"./transition-JR3jNvu7.js";import"./arrow-left-BMPE_XAu.js";import"./loader-circle-CIdMfzjo.js";import"./refresh-cw-CA0aJ90x.js";import"./FlashMessages-o0prhkl9.js";function ne(a,n){return Array.isArray(a)?a.includes("*")?!0:(Array.isArray(n)?n:[n]).some(t=>a.some(x=>x===t||x===t.replace(".view",".manage")||x===t.replace(".manage",".view"))):!1}const ce=[{label:"Nouvelle vente",route:"hardware.sales.create",icon:Y,permission:"hardware.sales.manage",color:"emerald"},{label:"Voir les ventes",route:"hardware.sales.index",icon:q,permission:"hardware.sales.view",color:"blue"},{label:"Ajouter un produit",route:"hardware.products.create",icon:h,permission:"hardware.product.manage",color:"amber"},{label:"Voir les produits",route:"hardware.products",icon:h,permission:"hardware.product.view",color:"slate"},{label:"Stock",route:"hardware.stock.index",icon:P,permission:"hardware.stock.view",color:"violet"},{label:"Mouvements",route:"hardware.stock.movements.index",icon:R,permission:"hardware.stock.movement.view",color:"indigo"},{label:"Rapports",route:"hardware.reports.index",icon:z,permission:"hardware.report.view",color:"cyan"},{label:"Bons de commande",route:"hardware.purchases.index",icon:b,permission:"hardware.purchases.view",color:"teal"},{label:"Clients",route:"hardware.customers.index",icon:F,permission:"hardware.customer.view",color:"purple"},{label:"Fournisseurs",route:"hardware.suppliers.index",icon:b,permission:"hardware.supplier.view",color:"orange"},{label:"Catégories",route:"hardware.categories.index",icon:S,permission:"hardware.category.view",color:"pink"}],xe={emerald:"bg-emerald-500 hover:bg-emerald-600",blue:"bg-blue-500 hover:bg-blue-600",amber:"bg-amber-500 hover:bg-amber-600",slate:"bg-slate-500 hover:bg-slate-600",violet:"bg-violet-500 hover:bg-violet-600",indigo:"bg-indigo-500 hover:bg-indigo-600",red:"bg-red-500 hover:bg-red-600",cyan:"bg-cyan-500 hover:bg-cyan-600",orange:"bg-orange-500 hover:bg-orange-600",teal:"bg-teal-500 hover:bg-teal-600",purple:"bg-purple-500 hover:bg-purple-600",pink:"bg-pink-500 hover:bg-pink-600"},me=[{value:7,label:"7 derniers jours"},{value:14,label:"14 derniers jours"},{value:30,label:"30 derniers jours"}];function T(a){return a?(typeof a=="string"?new Date(a):a).toISOString().slice(0,10):""}function Pe({stats:a,chartSalesLastDays:n=[],chartStockDistribution:c=[],filters:t={}}){const{auth:x,shop:_}=H().props,$=x?.permissions??[],L=_?.currency||"CDF",u=r=>J(r,L),m=Number(t?.period)||14,I=!!(t?.from&&t?.to),V=T(new Date(Date.now()-336*60*60*1e3)),K=T(new Date),[p,y]=g.useState(t?.from||V),[j,f]=g.useState(t?.to||K),O=I?`Ventes du ${t.from} au ${t.to}`:`Ventes des ${m} derniers jours`;g.useEffect(()=>{t?.from&&y(t.from),t?.to&&f(t.to)},[t?.from,t?.to]);const w=ce.filter(r=>ne($,r.permission)),B=r=>{const s=Number(r.target.value)||14;N.get(route("hardware.dashboard"),{period:s,from:"",to:""},{preserveState:!0})},U=()=>{N.get(route("hardware.dashboard"),{period:m,from:p||void 0,to:j||void 0},{preserveState:!0})},k=(n||[]).map(r=>({...r,dateShort:r.date?new Date(r.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):"",total:Number(r.total),count:Number(r.count)}));return e.jsxs(X,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-100 leading-tight",children:"Tableau de bord — Quincaillerie"}),children:[e.jsx(M,{title:"Tableau de bord Quincaillerie"}),e.jsxs("div",{className:"py-6 space-y-6 sm:space-y-8",children:[e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsx(o,{className:"pb-2",children:e.jsx(d,{className:"text-base text-gray-900 dark:text-white",children:"Filtres du graphique ventes"})}),e.jsx(i,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Période rapide :"}),e.jsx("select",{value:m,onChange:B,className:"rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:me.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 ml-2",children:"Date début"}),e.jsx("input",{type:"date",value:p,onChange:r=>y(r.target.value),className:"rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date fin"}),e.jsx("input",{type:"date",value:j,onChange:r=>f(r.target.value),className:"rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),e.jsx(C,{type:"button",onClick:U,className:"w-full sm:w-auto bg-amber-600 hover:bg-amber-700 text-white",children:"Appliquer"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Produits"}),e.jsx(h,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a?.products?.total??0}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a?.products?.active??0," actifs"]})]})]}),e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Stock bas"}),e.jsx(v,{className:"h-4 w-4 text-orange-500"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:a?.inventory?.low_stock_count??0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"À réapprovisionner"})]})]}),e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Valeur du stock"}),e.jsx(Z,{className:"h-4 w-4 text-green-500 dark:text-green-400"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u(a?.inventory?.total_value??0)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Valeur totale"})]})]}),e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Ruptures"}),e.jsx(P,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:a?.inventory?.out_of_stock_count??0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Produits en rupture"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 p-4",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(d,{className:"text-base flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(G,{className:"h-5 w-5 text-emerald-500"}),O]})}),e.jsx(i,{className:"h-72",children:k.length>0?e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(ee,{data:k,margin:{top:5,right:10,left:0,bottom:5},children:[e.jsx(re,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-600"}),e.jsx(ae,{dataKey:"dateShort",tick:{fontSize:11},className:"text-gray-600 dark:text-gray-400"}),e.jsx(te,{yAxisId:"left",tickFormatter:r=>r>=1e3?`${(r/1e3).toFixed(0)}k`:r,tick:{fontSize:11}}),e.jsx(D,{formatter:r=>{const s=Array.isArray(r)?r[0]:r;return[u(Number(s)),"Chiffre d'affaires"]},labelFormatter:(r,s)=>s[0]?.payload?.date&&new Date(s[0].payload.date).toLocaleDateString("fr-FR"),contentStyle:{borderRadius:8}}),e.jsx(se,{yAxisId:"left",type:"monotone",dataKey:"total",stroke:"#10b981",strokeWidth:2,dot:{fill:"#10b981",r:3},name:"CA"})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500 dark:text-gray-400 text-sm",children:"Aucune vente sur la période"})})]}),e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 p-4",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(d,{className:"text-base flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(R,{className:"h-5 w-5 text-violet-500"}),"Répartition du stock"]})}),e.jsx(i,{className:"h-72",children:c&&c.length>0?e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(le,{children:[e.jsx(oe,{data:c,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:({name:r,value:s})=>`${r}: ${s}`,children:c.map((r,s)=>e.jsx(de,{fill:r.fill},`cell-${s}`))}),e.jsx(D,{formatter:r=>[Array.isArray(r)?r[0]:r,"Produits"]}),e.jsx(ie,{})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500 dark:text-gray-400 text-sm",children:"Aucune donnée de stock"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Catégories"}),e.jsx(S,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a?.categories?.total??0}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a?.categories?.active??0," actives"]})]})]}),e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Fournisseurs"}),e.jsx(b,{className:"h-4 w-4 text-indigo-500"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a?.suppliers?.total??0}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a?.suppliers?.active??0," actifs"]})]})]}),e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Clients"}),e.jsx(F,{className:"h-4 w-4 text-purple-500"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a?.customers?.total??0}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a?.customers?.active??0," actifs"]})]})]})]}),a?.alerts?.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Alertes"}),e.jsx("div",{className:"space-y-3",children:a.alerts.map((r,s)=>e.jsx("div",{className:`p-4 rounded-lg border ${r.type==="danger"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:`h-5 w-5 mr-3 ${r.type==="danger"?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${r.type==="danger"?"text-red-800 dark:text-red-300":"text-yellow-800 dark:text-yellow-300"}`,children:r.message}),e.jsxs("p",{className:`text-sm ${r.type==="danger"?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400"}`,children:["Priorité : ",r.priority]})]})]})},s))})]}),w.length>0&&e.jsxs(l,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(d,{className:"text-base flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(W,{className:"h-5 w-5 text-amber-500"}),"Actions rapides"]})}),e.jsx(i,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(r=>{const s=r.icon,E=xe[r.color]||"bg-gray-500 hover:bg-gray-600";return e.jsx(C,{className:`${E} text-white text-sm`,asChild:!0,children:e.jsxs(Q,{href:route(r.route),className:"inline-flex items-center gap-2",children:[e.jsx(s,{className:"h-4 w-4"}),r.label]})},r.route)})})})]})]})]})}export{Pe as default};
