import{u as K,r as n,j as e,H as Q,L as W,a as g,z as h,c as Y}from"./app-BGTsh8B3.js";import{A as Z,p as E,C as _,P as j,l as P,m as ee,a3 as te,q as ae,r as se,E as re,c as le}from"./AppLayout-B9W2Qjn-.js";import{C as i,a as c,b as x,c as o}from"./card-DzyZZsrB.js";import{B as l}from"./Button-Cm51LcKk.js";import{I as de}from"./Input-LVtkliO7.js";import{B as z}from"./badge-vyxm7s9H.js";import{S as ne}from"./SupplierDrawer-z5Fb-s0N.js";import{E as ie}from"./ExportButtons-WFClV4Fz.js";import{C as B,U as ce}from"./x-Bqi0sytM.js";import"./createLucideIcon-B4miffV9.js";import"./shield-x-DRqpxde8.js";import"./user-cog-CgPvrrVM.js";import"./Dropdown-DbeWMHj2.js";import"./transition-JR3jNvu7.js";import"./arrow-left-BMPE_XAu.js";import"./loader-circle-CIdMfzjo.js";import"./refresh-cw-CA0aJ90x.js";import"./FlashMessages-o0prhkl9.js";import"./Drawer-D_RvWb8n.js";import"./Label-CEns7YJb.js";import"./textarea-Dc6vmaOE.js";function ze({suppliers:a,filters:u={},routePrefix:s="pharmacy"}){const{auth:F}=K().props,f=F?.permissions||[],[N,I]=n.useState(u.search||""),[k,T]=n.useState(u.status||""),[v,L]=n.useState(u.per_page||15),[w,C]=n.useState({}),[U,b]=n.useState(!1),[D,p]=n.useState(null),d=t=>f.includes("*")?!0:t.split("|").some(m=>f.includes(m)),y=d(`${s}.supplier.create`),S=d(`${s}.supplier.edit`),O=d(`${s}.supplier.view`),H=t=>{t.preventDefault(),g.get(route(`${s}.suppliers.index`),{search:N||void 0,status:k||void 0,per_page:v||void 0},{preserveState:!0})},$=()=>{p(null),b(!0)},q=t=>{p(t),b(!0)},M=()=>{b(!1),p(null)},R=()=>{g.reload({only:["suppliers"]})},A=async t=>{const m=t.status==="active"?"deactivate":"activate",J=t.status==="active"?`${s}.supplier.deactivate`:`${s}.supplier.activate`;if(!d(J)){h.error("Vous n'avez pas la permission pour cette action.");return}C(r=>({...r,[t.id]:!0}));try{const r=await Y.post(route(`${s}.suppliers.${m}`,t.id));r.data.success?(h.success(r.data.message),g.reload({only:["suppliers"]})):h.error(r.data.message)}catch{h.error("Une erreur est survenue.")}finally{C(r=>({...r,[t.id]:!1}))}},V=t=>t==="active"?e.jsx(z,{className:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:"Actif"}):e.jsx(z,{className:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:"Inactif"}),G=a.data?.filter(t=>t.status==="active").length||0,X=a.data?.filter(t=>t.status==="inactive").length||0;return e.jsxs(Z,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-100 leading-tight",children:"Gestion des Fournisseurs"}),children:[e.jsx(Q,{title:"Fournisseurs"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(i,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Total Fournisseurs"}),e.jsx(E,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.total||0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"enregistrés"})]})]}),e.jsxs(i,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Actifs"}),e.jsx(B,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:G}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"fournisseurs actifs"})]})]}),e.jsxs(i,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Inactifs"}),e.jsx(_,{className:"h-4 w-4 text-gray-500"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:X}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"fournisseurs inactifs"})]})]}),y&&e.jsxs(i,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Action rapide"}),e.jsx(j,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(o,{children:e.jsxs(l,{onClick:$,className:"w-full bg-amber-500 hover:bg-amber-600 text-white inline-flex items-center justify-center gap-2",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{children:"Nouveau fournisseur"})]})})]})]}),e.jsxs(i,{className:"mb-6 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between",children:[e.jsxs(x,{className:"flex items-center text-gray-900 dark:text-white",children:[e.jsx(P,{className:"h-5 w-5 mr-2 text-amber-500"}),"Filtres"]}),e.jsx(ie,{pdfUrl:route(`${s}.exports.suppliers.pdf`),excelUrl:route(`${s}.exports.suppliers.excel`),disabled:!a.data?.length})]}),e.jsx(o,{children:e.jsxs("form",{onSubmit:H,className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Recherche"}),e.jsx(de,{type:"text",value:N,onChange:t=>I(t.target.value),placeholder:"Nom, contact, email, téléphone...",className:"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Statut"}),e.jsxs("select",{className:"h-10 rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-amber-500",value:k,onChange:t=>T(t.target.value),children:[e.jsx("option",{value:"",children:"Tous"}),e.jsx("option",{value:"active",children:"Actifs"}),e.jsx("option",{value:"inactive",children:"Inactifs"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Par page"}),e.jsxs("select",{className:"h-10 rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100 px-3 focus:outline-none focus:ring-2 focus:ring-amber-500",value:v,onChange:t=>L(t.target.value),children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"})]})]}),e.jsxs(l,{type:"submit",className:"bg-amber-500 hover:bg-amber-600 text-white inline-flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Filtrer"})]})]})})]}),e.jsxs(i,{className:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700",children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center text-gray-900 dark:text-white",children:[e.jsx(ce,{className:"h-5 w-5 mr-2 text-blue-500"}),"Liste des fournisseurs (",a.total||0,")"]})}),e.jsx(o,{children:!a.data||a.data.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(E,{className:"h-12 w-12 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Aucun fournisseur trouvé."}),y&&e.jsxs(l,{onClick:$,className:"bg-amber-500 hover:bg-amber-600 text-white inline-flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{children:"Créer un fournisseur"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Nom"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Téléphone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Commandes"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-slate-700",children:a.data.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center",children:e.jsx(te,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Créé le ",t.created_at]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300",children:t.contact_person||"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.phone?e.jsxs("span",{className:"inline-flex items-center text-sm text-gray-700 dark:text-gray-300",children:[e.jsx(ae,{className:"h-3 w-3 mr-1 text-gray-400"}),t.phone]}):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.email?e.jsxs("span",{className:"inline-flex items-center text-sm text-gray-700 dark:text-gray-300",children:[e.jsx(se,{className:"h-3 w-3 mr-1 text-gray-400"}),t.email]}):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",children:t.total_orders})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:V(t.status)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right space-x-2",children:[O&&e.jsx(l,{variant:"outline",size:"sm",asChild:!0,className:"border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700",children:e.jsx(W,{href:route(`${s}.suppliers.show`,t.id),children:e.jsx(re,{className:"h-4 w-4"})})}),S&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>q(t),className:"border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700",children:e.jsx(le,{className:"h-4 w-4"})}),t.status==="active"&&d(`${s}.supplier.deactivate`)&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>A(t),disabled:w[t.id],className:"border-orange-300 dark:border-orange-600 text-orange-700 dark:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20",children:e.jsx(_,{className:"h-4 w-4"})}),t.status==="inactive"&&d(`${s}.supplier.activate`)&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>A(t),disabled:w[t.id],className:"border-green-300 dark:border-green-600 text-green-700 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20",children:e.jsx(B,{className:"h-4 w-4"})})]})]},t.id))})]})}),a.links&&a.links.length>3&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200 dark:border-slate-700",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Affichage de ",a.from," à ",a.to," sur ",a.total," résultats"]}),e.jsx("div",{className:"flex gap-1",children:a.links.map((t,m)=>e.jsx(l,{variant:t.active?"default":"outline",size:"sm",disabled:!t.url,onClick:()=>t.url&&g.get(t.url),className:t.active?"bg-amber-500 hover:bg-amber-600 text-white":"border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-200",dangerouslySetInnerHTML:{__html:t.label}},m))})]})]})})]})]})}),e.jsx(ne,{isOpen:U,onClose:M,supplier:D,onSuccess:R,canCreate:y,canUpdate:S,routePrefix:s})]})}export{ze as default};
