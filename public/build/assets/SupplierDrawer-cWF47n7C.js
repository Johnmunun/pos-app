import{r as x,j as e,z as d,c as j}from"./app-3PKVeuQh.js";import{D as E}from"./Drawer-DXvnJU94.js";import{L as i}from"./Label-DCTvEg5s.js";import{I as g}from"./Input-5gvkn2nv.js";import{T as _}from"./textarea-g7yOinAB.js";import{B as N}from"./Button-RC9FN5z3.js";import{J as S,f as C,i as D,M as F,l as P,o as z}from"./AppLayout-DSrKCpOy.js";import{X as A}from"./x-YL0zAneP.js";function V({isOpen:f,onClose:h,supplier:t=null,onSuccess:y=null,canCreate:v=!1,canUpdate:k=!1}){const l=!!t,[o,u]=x.useState({name:"",contact_person:"",phone:"",email:"",address:""}),[s,c]=x.useState({}),[n,b]=x.useState(!1);x.useEffect(()=>{u(t?{name:t.name||"",contact_person:t.contact_person||"",phone:t.phone||"",email:t.email||"",address:t.address||""}:{name:"",contact_person:"",phone:"",email:"",address:""}),c({})},[t,f]);const m=(a,r)=>{u(p=>({...p,[a]:r})),s[a]&&c(p=>({...p,[a]:null}))},w=async a=>{if(a.preventDefault(),l&&!k){d.error("Vous n'avez pas la permission de modifier un fournisseur");return}if(!l&&!v){d.error("Vous n'avez pas la permission de créer un fournisseur");return}b(!0),c({});try{let r;l?r=await j.put(route("pharmacy.suppliers.update",t.id),o):r=await j.post(route("pharmacy.suppliers.store"),o),r.data.success?(d.success(r.data.message),h(),y&&y()):d.error(r.data.message||"Une erreur est survenue")}catch(r){r.response?.status===422?r.response.data.errors?c(r.response.data.errors):r.response.data.message&&d.error(r.response.data.message):d.error("Erreur lors de l'enregistrement du fournisseur")}finally{b(!1)}};return e.jsx(E,{isOpen:f,onClose:h,title:l?"Modifier le fournisseur":"Nouveau fournisseur",children:e.jsxs("form",{onSubmit:w,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"name",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(S,{className:"h-4 w-4 text-gray-400"}),"Nom du fournisseur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(g,{id:"name",type:"text",value:o.name,onChange:a=>m("name",a.target.value),placeholder:"Ex: Pharma Distribution SARL",className:"mt-1 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",required:!0,disabled:n}),s.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.name})]}),e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"contact_person",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(C,{className:"h-4 w-4 text-gray-400"}),"Personne de contact"]}),e.jsx(g,{id:"contact_person",type:"text",value:o.contact_person,onChange:a=>m("contact_person",a.target.value),placeholder:"Ex: Jean Dupont",className:"mt-1 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",disabled:n}),s.contact_person&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.contact_person})]}),e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"phone",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(D,{className:"h-4 w-4 text-gray-400"}),"Téléphone"]}),e.jsx(g,{id:"phone",type:"tel",value:o.phone,onChange:a=>m("phone",a.target.value),placeholder:"Ex: +243 999 000 000",className:"mt-1 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",disabled:n}),s.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.phone})]}),e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"email",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(F,{className:"h-4 w-4 text-gray-400"}),"Email"]}),e.jsx(g,{id:"email",type:"email",value:o.email,onChange:a=>m("email",a.target.value),placeholder:"Ex: contact@pharma.com",className:"mt-1 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",disabled:n}),s.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.email})]}),e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"address",className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(P,{className:"h-4 w-4 text-gray-400"}),"Adresse"]}),e.jsx(_,{id:"address",value:o.address,onChange:a=>m("address",a.target.value),placeholder:"Ex: 123 Avenue du Commerce, Kinshasa",rows:3,className:"mt-1 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",disabled:n}),s.address&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.address})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs(N,{type:"button",variant:"outline",onClick:h,className:"w-full sm:w-auto",disabled:n,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Annuler"]}),e.jsxs(N,{type:"submit",className:"w-full sm:w-auto bg-amber-500 dark:bg-amber-600 text-white hover:bg-amber-600 dark:hover:bg-amber-700",disabled:n,children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),n?"Enregistrement...":l?"Enregistrer":"Créer"]})]})]})})}export{V as S};
