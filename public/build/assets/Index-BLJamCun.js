import{u as q,r as m,j as e,H,a as S,n as g}from"./app-BGTsh8B3.js";import{A as I,W as y,P,M as R,q as $,r as L,c as W,s as U,t as V,B as G}from"./AppLayout-B9W2Qjn-.js";import{B as n}from"./Button-Cm51LcKk.js";import{I as d}from"./Input-LVtkliO7.js";import{L as i}from"./Label-CEns7YJb.js";import{B as A}from"./badge-vyxm7s9H.js";import{M as J}from"./Modal-OSZm3TU8.js";import"./createLucideIcon-B4miffV9.js";import"./shield-x-DRqpxde8.js";import"./x-Bqi0sytM.js";import"./user-cog-CgPvrrVM.js";import"./Dropdown-DbeWMHj2.js";import"./transition-JR3jNvu7.js";import"./arrow-left-BMPE_XAu.js";import"./loader-circle-CIdMfzjo.js";import"./refresh-cw-CA0aJ90x.js";import"./FlashMessages-o0prhkl9.js";function he({depots:j=[]}){const{auth:N}=q().props,b=N?.permissions||[],v=N?.user?.type,E=v==="ROOT"||v==="root",D=b.includes("*"),x=a=>E||D?!0:b.includes(a),f=x("hardware.warehouse.create"),F=x("hardware.warehouse.update"),k=x("hardware.warehouse.activate"),w=x("hardware.warehouse.deactivate"),[z,o]=m.useState(!1),[c,u]=m.useState(null),[r,t]=m.useState({name:"",code:"",address:"",city:"",postal_code:"",country:"CM",phone:"",email:""}),[l,h]=m.useState({}),[p,C]=m.useState(!1),M=()=>{u(null),t({name:"",code:"",address:"",city:"",postal_code:"",country:"CM",phone:"",email:""}),h({}),o(!0)},O=a=>{u(a),t({name:a.name||"",code:a.code||"",address:a.address||"",city:a.city||"",postal_code:a.postal_code||"",country:a.country||"CM",phone:a.phone||"",email:a.email||""}),h({}),o(!0)},X=a=>{a.preventDefault(),C(!0),h({});const s=c?"put":"post",B=c?route("hardware.depots.update",c.id):route("hardware.depots.store");S[s](B,r,{preserveScroll:!0,onSuccess:()=>{o(!1),u(null),t({name:"",code:"",address:"",city:"",postal_code:"",country:"CM",phone:"",email:""})},onError:T=>h(T||{}),onFinish:()=>C(!1)})},_=a=>{if(!a.is_active&&!k){g.error("Permission refusée");return}if(a.is_active&&!w){g.error("Permission refusée");return}const s=a.is_active?"hardware.depots.deactivate":"hardware.depots.activate";S.post(route(s,a.id),{},{preserveScroll:!0,onSuccess:()=>{},onError:()=>{g.error("Erreur lors de la modification")}})};return e.jsxs(I,{header:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(y,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-white leading-tight",children:"Dépôts"})]}),f&&e.jsxs(n,{onClick:M,className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Nouveau dépôt"]})]}),children:[e.jsx(H,{title:"Dépôts - Hardware"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Gérez vos dépôts. Sélectionnez un dépôt dans la barre de navigation pour accéder aux produits et au stock de ce dépôt."}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:j.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(y,{className:"h-12 w-12 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-600 dark:text-gray-300 mb-2",children:"Aucun dépôt"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Créez votre premier dépôt pour commencer."}),f&&e.jsxs(n,{onClick:M,className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Créer un dépôt"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Dépôt"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Adresse"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:j.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:e.jsx(y,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a.name})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded",children:a.code})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:a.address||a.city?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"h-3 w-3 shrink-0"}),[a.address,a.city,a.postal_code].filter(Boolean).join(", "),a.country&&a.country!=="CM"&&` (${a.country})`]}):"—"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"space-y-1",children:[a.phone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),a.phone]}),a.email&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-3 w-3"}),a.email]}),!a.phone&&!a.email&&"—"]})}),e.jsx("td",{className:"px-6 py-4",children:a.is_active?e.jsx(A,{className:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-300",children:"Actif"}):e.jsx(A,{variant:"secondary",children:"Inactif"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[F&&e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>O(a),className:"gap-1",children:[e.jsx(W,{className:"h-3 w-3"}),"Modifier"]}),a.is_active?w&&e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>_(a),className:"gap-1 text-red-600 hover:text-red-700",children:[e.jsx(U,{className:"h-3 w-3"}),"Désactiver"]}):k&&e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>_(a),className:"gap-1 text-emerald-600 hover:text-emerald-700",children:[e.jsx(V,{className:"h-3 w-3"}),"Activer"]})]})})]},a.id))})]})})})]})}),e.jsx(J,{show:z,onClose:()=>!p&&o(!1),maxWidth:"md",children:e.jsxs("form",{onSubmit:X,className:"p-6 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(G,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"}),c?"Modifier le dépôt":"Nouveau dépôt"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:c?"Modifiez les informations du dépôt":"Remplissez les informations pour créer un nouveau dépôt"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"name",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:["Nom du dépôt ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{id:"name",value:r.name,onChange:a=>t(s=>({...s,name:a.target.value})),placeholder:"Ex: Dépôt principal",required:!0,className:`mt-1 ${l.name?"border-red-500":""}`}),l.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:l.name})]}),e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"code",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:["Code du dépôt ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{id:"code",value:r.code,onChange:a=>t(s=>({...s,code:a.target.value.toUpperCase().replace(/\s/g,"-")})),placeholder:"Ex: DEPOT-1",required:!0,className:`mt-1 ${l.code?"border-red-500":""}`}),l.code&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:l.code})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"address",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Adresse"}),e.jsx(d,{id:"address",value:r.address,onChange:a=>t(s=>({...s,address:a.target.value})),placeholder:"Adresse complète",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"city",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Ville"}),e.jsx(d,{id:"city",value:r.city,onChange:a=>t(s=>({...s,city:a.target.value})),placeholder:"Ville",className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"postal_code",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Code postal"}),e.jsx(d,{id:"postal_code",value:r.postal_code,onChange:a=>t(s=>({...s,postal_code:a.target.value})),placeholder:"Code postal",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"country",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Pays"}),e.jsx(d,{id:"country",value:r.country,onChange:a=>t(s=>({...s,country:a.target.value})),placeholder:"CM",className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"phone",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Téléphone"}),e.jsx(d,{id:"phone",type:"tel",value:r.phone,onChange:a=>t(s=>({...s,phone:a.target.value})),placeholder:"+237 6XX XXX XXX",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"email",className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Email"}),e.jsx(d,{id:"email",type:"email",value:r.email,onChange:a=>t(s=>({...s,email:a.target.value})),placeholder:"depot@example.com",className:`mt-1 ${l.email?"border-red-500":""}`}),l.email&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:l.email})]})]})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>o(!1),disabled:p,children:"Annuler"}),e.jsx(n,{type:"submit",disabled:p,className:"bg-amber-600 hover:bg-amber-700 text-white",children:p?c?"Mise à jour...":"Création...":c?"Mettre à jour":"Créer le dépôt"})]})]})})]})}export{he as default};
